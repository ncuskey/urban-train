<!DOCTYPE html>
<html>
<head>
    <title>Ocean Label Styling Test</title>
    <style>
        body { font-family: monospace; margin: 20px; }
        .test-section { margin: 20px 0; padding: 10px; border: 1px solid #ccc; }
        .success { color: green; }
        .info { color: blue; }
        
        #test-svg {
            border: 1px solid #ccc;
            background: #5E4FA2;
        }
    </style>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Ocean Label Styling Test</h1>
    
    <div class="test-section">
        <h2>Test Results</h2>
        <div id="results"></div>
    </div>
    
    <div class="test-section">
        <h2>SVG Test Area</h2>
        <svg id="test-svg" width="600" height="400">
            <g id="viewport">
                <g id="world">
                    <g id="map"></g>
                    <g id="labels">
                        <g id="labels-features"></g>
                    </g>
                </g>
            </g>
        </svg>
    </div>

    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script type="module">
        import { placeOceanLabelCentered } from './src/modules/labels.js';
        
        function runTest() {
            const results = [];
            const svg = d3.select('#test-svg');
            
            try {
                // Test 1: Place ocean label using the updated function
                const testRect = { x: 100, y: 100, width: 200, height: 80 };
                const oceanName = "Mare Thalassa";
                
                // Place the ocean label
                placeOceanLabelCentered(svg.select('#labels'), oceanName, testRect);
                
                // Check if the label was created with the correct class
                const label = svg.select('#labels text.place-label.ocean');
                if (!label.empty()) {
                    results.push(`<div class="success">‚úÖ Ocean label created successfully</div>`);
                    results.push(`<div class="info">üìç Label text: "${oceanName}"</div>`);
                    results.push(`<div class="info">üé® CSS class: ${label.attr('class')}</div>`);
                    
                    // Check if inline styles are minimal (only font-size should be set)
                    const fontSize = label.style('font-size');
                    const fill = label.style('fill');
                    const fontFamily = label.style('font-family');
                    
                    results.push(`<div class="info">üìè Font size (inline): ${fontSize}</div>`);
                    results.push(`<div class="info">üé® Fill (should be from CSS): ${fill || 'not set (using CSS)'}</div>`);
                    results.push(`<div class="info">üî§ Font family (should be from CSS): ${fontFamily || 'not set (using CSS)'}</div>`);
                    
                    if (!fill && !fontFamily) {
                        results.push(`<div class="success">‚úÖ No inline fill/font-family - CSS styling is working!</div>`);
                    } else {
                        results.push(`<div class="warning">‚ö†Ô∏è Some inline styles still present - may need cleanup</div>`);
                    }
                    
                    // Visualize the test rectangle
                    svg.select('#map').append('rect')
                        .attr('x', testRect.x)
                        .attr('y', testRect.y)
                        .attr('width', testRect.width)
                        .attr('height', testRect.height)
                        .attr('fill', 'none')
                        .attr('stroke', '#ff0000')
                        .attr('stroke-width', 2)
                        .attr('stroke-dasharray', '5,5');
                        
                } else {
                    results.push(`<div class="error">‚ùå Ocean label not found</div>`);
                }
                
            } catch (error) {
                results.push(`<div class="error">‚ùå Error: ${error.message}</div>`);
                console.error('Test error:', error);
            }
            
            return results;
        }
        
        // Run test and display results
        const results = runTest();
        document.getElementById('results').innerHTML = results.join('');
    </script>
</body>
</html>
