/* Import fantasy fonts from Google Fonts */
@import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=UnifrakturMaguntia&family=MedievalSharp&family=Alegreya+SC:wght@400;700&family=Crimson+Text:wght@400;600;700&family=Lora:wght@400;500;600;700&family=Merriweather:wght@300;400;700;900&display=swap');

input {
  width: 100px;
  height: 14px;
}

:root {
  /* Fantasy font options - change this to switch themes */
  --label-font: 'Cinzel', serif;
  --label-font-family: 'Cinzel', serif;
  
  /* Alternative fantasy fonts (uncomment to use):
  --label-font: 'UnifrakturMaguntia', cursive;
  --label-font-family: 'UnifrakturMaguntia', cursive;
  
  --label-font: 'MedievalSharp', cursive;
  --label-font-family: 'MedievalSharp', cursive;
  
  --label-font: 'Alegreya SC', serif;
  --label-font-family: 'Alegreya SC', serif;
  
  --label-font: 'Crimson Text', serif;
  --label-font-family: 'Crimson Text', serif;
  
  --label-font: 'Lora', serif;
  --label-font-family: 'Lora', serif;
  
  --label-font: 'Merriweather', serif;
  --label-font-family: 'Merriweather', serif;
  */
}

svg {
  background-color: #5E4FA2;
}

.mapCell {
  stroke-width: 0.2;
  shape-rendering: optimizeSpeed;
  pointer-events: none;
}

/* LOD system CSS */
.mapCells.no-stroke path, .mapCells.no-stroke polygon { 
  stroke: none; 
}
.mapCells path, .mapCells polygon { 
  shape-rendering: optimizeSpeed; 
  pointer-events: none;
}

.mapStroke {
  stroke-width: 0.2;
  fill: none;
  stroke-linejoin: round;
}

.blur {
  fill: none;
  filter: url(#blurFilter);
}

.circle {
  stroke: black;
  stroke-width: 1px;
}



.islandBack {
  fill: rgb(109, 192, 168);
  stroke: none;
}

.coastline {
  fill: none;
  stroke: black;
  stroke-width: 0.5px;
  stroke-linejoin: round;
}

.lakecoast {
  fill: hsl(209, 46%, 55%);
  stroke-width: 0.3px;
  stroke: rgb(50, 94, 130);
  stroke-linejoin: round;
}

.oceanLayer {
  fill: #5E4FA2;
  mask: url(#shape);
}

.shallow {
  fill: url(#shallowHatch);
  mask: url(#shape);
  stroke: none;
  opacity: 0.8;
}

/* Label styling - now global for all labels */
.place-label {
  fill: white;
  stroke: black;
  stroke-width: 0.5px;
  font-family: var(--label-font);
  font-weight: 700;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
  pointer-events: none;
}

/* Unified font styling for all label types */
#labels text.stroke,
#labels text.fill,
#labels-features g.label text.stroke,
#labels-features g.label text.fill,
.place-label {
  font-family: var(--label-font);
  font-weight: 700;
}

/* Big ocean label — inherits base .place-label settings */
text.place-label.ocean {
  fill: #fff;                  /* matches other labels */
  stroke: rgba(0,0,0,.9);
  stroke-width: 3px;
  font-weight: 700;
  letter-spacing: .4px;
  paint-order: stroke fill;
  pointer-events: none;
}

/* Label visibility control - hidden by default, shown only when JS sets class */
#labels text {
  opacity: 0;
  pointer-events: none;
  transition: opacity 140ms ease-out;
}

#labels text.is-visible {
  opacity: 1;
  pointer-events: auto;
  /* keep display: block so the transition is visible */
}

/* Smooth transitions for LOD visibility changes */
#labels-world g.label { 
  transition: opacity 120ms linear; 
}

#labels-world g.label:not(.is-visible) { 
  pointer-events: none; 
}

/* Different styling for different feature types */
.place-label.island {
  fill: #2d5016;
  stroke: #1a2f0d;
  font-weight: 900;
}

.place-label.lake {
  fill: #0369a1;
  stroke: #0c4a6e;
  font-weight: 700;
}

/* HUD styling */
#hud {
  pointer-events: none;
}

/* Debug circle styling for ocean label validation */
.debug-circle {
  pointer-events: none;
  z-index: 1000;
}

/* Debug ocean rectangle kill switch */
.debug-ocean-rect,
.ocean-bbox,
.ocean-debug,
#labels-debug rect { 
  display: none !important; 
}

#hud .tip text {
  fill: white;
  font-family: Arial, sans-serif;
  font-size: 12px;
  font-weight: bold;
}

/* Feature label styling */
#labels text.stroke {
  paint-order: stroke;
  stroke: #000;
  stroke-width: 2px;     /* was 3px */
  stroke-linejoin: round;
  fill: none;
  opacity: 0.7;          /* was 0.8 */
  vector-effect: non-scaling-stroke; /* keeps stroke width pleasant */
}

#labels text.fill {
  fill: #fff;
  letter-spacing: 0.3px;
}

#labels-features text.fill {
  font-size: 16px;
  font-weight: 700;      /* crisper fill, thinner stroke */
  opacity: 0.95;
}

/* Make sure labels are visible */
#labels-features g.label text {
  font-size: 16px;
  font-weight: bold;
  fill: white;
  stroke: black;
  stroke-width: 2px;
  paint-order: stroke;
}

/* Ensure label text elements are properly styled */
#labels-features g.label text.stroke {
  paint-order: stroke;
  stroke: #000;
  stroke-width: 2px;
  stroke-linejoin: round;
  fill: none;
  opacity: 0.7;
  vector-effect: non-scaling-stroke;
}

#labels-features g.label text.fill {
  fill: #fff;
  letter-spacing: 0.3px;
  font-size: 16px;
  font-weight: 700;
  opacity: 0.95;
}

/* Ocean label styling in new system */
#labels-features g.label text.stroke.ocean {
  stroke: rgba(0,0,0,.9);
  stroke-width: 3px;
  opacity: 0.8;
}

#labels-features g.label text.fill.ocean {
  fill: #fff;
  font-weight: 700;
  letter-spacing: .4px;
  opacity: 1;
}

/* Lake label styling in new system */
#labels-features g.label text.stroke.lake {
  stroke: #0c4a6e;
  stroke-width: 2px;
  opacity: 0.7;
}

#labels-features g.label text.fill.lake {
  fill: #0369a1;
  font-weight: 700;
}

/* Island label styling in new system */
#labels-features g.label text.stroke.island {
  stroke: #1a2f0d;
  stroke-width: 2px;
  opacity: 0.7;
}

#labels-features g.label text.fill.island {
  fill: #2d5016;
  font-weight: 900;
}

/* Hooks – inactive until flags are set in JS */
.label--water { font-style: italic; }
.label--area  { text-transform: uppercase; letter-spacing: 0.08em; }
.label--tracked-tight { letter-spacing: 0.05em; }

/* CSS safety: prevent stale display:none inheritance */
#labels-world .feature-label { display: unset; }
#labels-overlay .feature-label { display: unset; }

/* Ocean label crisp outlines that don't fatten/thin with zoom */
.label.ocean text { vector-effect: non-scaling-stroke; }

/* Tier-based label styling */
.label.tier-1 text {
  font-weight: 900;
  letter-spacing: 0.5px;
}

.label.tier-2 text {
  font-weight: 800;
  letter-spacing: 0.3px;
}

.label.tier-3 text {
  font-weight: 700;
  letter-spacing: 0.2px;
}

.label.tier-4 text {
  font-weight: 600;
  letter-spacing: 0.1px;
}

/* Ocean label: fixed size, bold, centered */
#labels-world text.label--ocean,
.label.ocean text.label--ocean {
  font-size: 22px !important;           /* adjust as desired */
  font-weight: 700 !important;
  text-anchor: middle !important;
  dominant-baseline: middle !important;
  pointer-events: none !important;
}
.hidden { display: none; }

/* off-screen virtualization */
.culled { display: none; }

/* Unify fonts between world-space and overlay labels */
#labels .label text,
#labels-overlay .ocean-text {
  font-family: var(--label-font, "IM FELL English", serif);
  font-kerning: normal;
  font-feature-settings: "liga" 1, "kern" 1;
  letter-spacing: 0.02em;
}

.layers-panel {
  position: absolute;
  top: 8px;
  right: 8px;
  background: rgba(22, 22, 28, 0.8);
  color: #f2f2f2;
  font: 12px/1.4 var(--label-font, ui-sans-serif);
  padding: 8px 10px;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.3);
  z-index: 10;
  user-select: none;
}
.layers-panel label { display: block; margin: 4px 0; white-space: nowrap; }
.layers-panel input { vertical-align: middle; margin-right: 6px; }
.layers-panel .layers-row { display: flex; gap: 6px; margin-top: 6px; }
.layers-panel .layers-field { display:flex; align-items:center; gap:6px; }
.layers-panel button {
  font: inherit; padding: 2px 8px; border-radius: 6px; border: 1px solid #777; background: #2a2a35; color: #fff;
}
.layers-panel button:hover { filter: brightness(1.1); }

/* Scalar legend */
.layers-legend {
  margin-top: 6px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  padding: 6px;
  display: none; /* shown only when Scalar is enabled */
}
.layers-legend svg { display: block; }
.layers-legend .legend-title {
  font-weight: 600;
  font-size: 12px;
  opacity: .9;
  margin-bottom: 4px;
}
.layers-legend .legend-label {
  font-size: 10px;
  fill: #eaeaf0;
  opacity: .95;
}

/* River styling */
#riversShade .riverShade { pointer-events: none; }
#rivers path.river      { pointer-events: none; }
